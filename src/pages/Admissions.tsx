import { useState } from 'react'
export default function Admissions(){const [status,setStatus]=useState('idle' as 'idle'|'sending'|'sent'|'error');const endpoint=import.meta.env.VITE_FORM_ENDPOINT as string|undefined;const [err,setErr]=useState('');async function onSubmit(e:React.FormEvent<HTMLFormElement>){e.preventDefault();setErr('');const form=e.currentTarget;const data=new FormData(form);data.append('_subject','Demande d\'information — Master ISC');try{if(!endpoint) throw new Error('Le point d\'envoi n\'est pas configuré (VITE_FORM_ENDPOINT).');setStatus('sending');const res=await fetch(endpoint,{method:'POST',headers:{Accept:'application/json'},body:data});if(!res.ok) throw new Error((await res.text())||'Erreur réseau');setStatus('sent');form.reset()}catch(e:any){setErr(e.message||'Erreur inconnue');setStatus('error')}}return(<section className='container py-12'><div className='grid md:grid-cols-2 gap-10'><div><h2 className='section-title mb-2'>Candidature & prérequis</h2><p className='opacity-80'>Les modalités (diplômes requis, calendrier, pièces, alternance) sont sur la page UL.</p><div className='mt-4 flex gap-3'><a className='btn btn-primary' href='https://fst.univ-lorraine.fr/formations/master-ingenierie-des-systemes-complexes/' target='_blank' rel='noreferrer'>Candidater maintenant</a><a className='btn' href='/parcours'>Voir les parcours</a></div></div><div className='card'><div className='card-header'><div className='card-title'>Demander des informations</div></div><div className='card-content space-y-3'>{status==='sent'?<div className='p-3 rounded-xl border bg-emerald-50 text-emerald-800'>✅ Votre mail a bien été transmis au service de l’université.</div>:<form onSubmit={onSubmit}><input name='name' className='w-full px-3 py-2 rounded-2xl border' placeholder='Nom et prénom' required/><input name='email' className='w-full px-3 py-2 rounded-2xl border mt-2' placeholder='Adresse email' type='email' required/><textarea name='message' className='w-full px-3 py-2 rounded-2xl border mt-2' placeholder='Votre message' rows={4} required></textarea><button className='btn mt-3' type='submit' disabled={status==='sending'}>{status==='sending'?'Envoi…':'Envoyer'}</button>{status==='error'&&<p className='text-sm text-red-600 mt-2'>{err}</p>}</form>}<p className='text-xs opacity-60'>Ce formulaire envoie sans ouvrir Gmail.</p></div></div></div></section>) }
